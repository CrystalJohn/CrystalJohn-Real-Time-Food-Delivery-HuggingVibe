| Milestone                                             | Frontend – Pages cần code                                                                                                                           | Frontend – Trong page có gì                                                                                                                                                                                                                                                                                           | Backend – Modules cần làm                                                                                                    | DB/Schema tối thiểu                                                     | API endpoints                                                                                                                                                                                                          | Events (Pub/Sub)                                                                                                                                                                                    |
| ----------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **M1 (W1–2)** Foundation + “Order đặt được”           | - `/login`  - `/(customer)/menu`  - `/(customer)/orders/[orderId]`  - Route groups/layout: `/(customer)/(staff)/(driver)/(admin)` + `/unauthorized` | **`/login`**  - Form login  - Call login API → lưu token/role  - Redirect theo role  - Guard: chưa login/sai role  **`/menu`**  - Menu mock/seed  - Cart (add/remove/qty)  - Place order  **`/orders/[id]`**  - Fetch order  - Show `orderId` + `orderStatus` + items                                                 | - `ConfigModule`, `MongoModule`, `EventingModule`  - `auth/users` minimal  - `ordering` minimal                              | - `users`  - `orders`                                                   | - `POST /auth/login` (stub ok)  - `POST /orders`  - `GET /orders/:id`  - (optional) `GET /menu`                                                                                                                        | **Pub:**  - `OrderPlaced`                                                                                                                                                                           |
| **M2 (W3–4)** Staff workflow + event sync             | - `/(staff)/tickets`  - `/(staff)/tickets/[ticketId]`  - Update `/(customer)/orders/[orderId]` (polling)                                            | **`/staff/tickets`**  - List PENDING (limit=4)  - Refresh/polling  **`/staff/tickets/[id]`**  - Show detail  - Accept/Reject/Ready  - Disable theo trạng thái  **`/customer/orders/[id]`**  - Polling status  - Status badge mapping                                                                                  | - `order-processing` (kitchen tickets)  - `ordering/subscribers` update order status  - Fix guards staff                     | - `kitchenTickets`  - Update `orders.orderStatus` mapping               | - `GET /tickets?status=PENDING&limit=4`  - `GET /tickets/:id` (khuyên có)  - `POST /tickets/:id/accept`  - `POST /tickets/:id/reject`  - `POST /tickets/:id/ready`  - `GET /orders/:id`                                | **Sub:** `OrderPlaced` → create ticket  **Pub:** `TicketConfirmed`, `TicketRejected`, `TicketReady`  **Sub (ordering):** ticket events → update order                                               |
| **M3 (W5–6)** Driver accept + Tracking realtime (WS)  | - `/(driver)/jobs`  - `/(driver)/jobs/[jobId]`  - `/(customer)/tracking/[orderId]`                                                                  | **`/driver/jobs`**  - List READY jobs  - Accept job  **`/driver/jobs/[id]`**  - Pickup/Complete  - WS connect  - Send location interval 3–5s  - Geo permission fallback  **`/customer/tracking/[orderId]`**  - WS subscribe order  - Show last location (text/map placeholder)  - Realtime status or polling fallback | - `delivery` module (jobs)  - `tracking` module (locations + sessions)  - WS gateway  - `ordering` subscribe delivery events | - `deliveryJobs`  - `trackingSessions`  - `driverLocations` (last-only) | - `GET /delivery/jobs`  - `POST /delivery/jobs/:id/accept`  - `POST /delivery/jobs/:id/pickup`  - `POST /delivery/jobs/:id/complete`  - (khuyên) `GET /tracking/:orderId/last`  - WS: driver emit + customer subscribe | **Sub:** `TicketReady` → create job READY  **Pub:** `DeliveryAccepted`, `DeliveryDelivered` (+ optional PickedUp)  **Sub (tracking):** start/stop session  **Sub (ordering):** update `orderStatus` |
| **M4 (W7–8)** Admin approve driver + tracking upgrade | - `/(admin)/drivers`  - (optional) `/(driver)/apply`  - Polish tracking UI                                                                          | **`/admin/drivers`**  - List applications + filter  - Approve + confirm modal  - Error/empty state  **`/driver/apply` (opt)**  - Form apply  - Show pending status  **Tracking polish**  - Marker đẹp hơn  - ETA UI (nếu có)                                                                                          | - Driver recruitment/approval endpoints  - Hardening transition validation                                                   | - `drivers` (or driverProfile)                                          | - `POST /drivers/apply`  - `GET /admin/drivers?status=`  - `POST /admin/drivers/:id/approve`                                                                                                                           | (optional) `DriverApplied`, `DriverApproved`                                                                                                                                                        |
| **M5 (W9–10)** Statistics + polish integration        | - `/(admin)/dashboard`  - Polish toàn bộ UX                                                                                                         | **Dashboard**  - Summary cards (orders/revenue)  - Daily chart + date range  - Loading/error/empty state  **Polish**  - Guard chuẩn  - Re-try/fallback UI  - Consistent status labels                                                                                                                                 | - `statistics` aggregate  - Reliability: idempotent handlers + logging                                                       | - Aggregate từ `orders` (optional cache `dailyStats`)                   | - `GET /admin/stats/summary`  - `GET /admin/stats/daily?from&to`                                                                                                                                                       | (optional) none                                                                                                                                                                                     |
| **Week 11** Finalization                              | - Demo script pages + seed UI  - Bugfix + README/API docs                                                                                           | - Click-flow “happy path”  - Fallback khi WS fail                                                                                                                                                                                                                                                                     | - Docker deploy + env config  - Seed + smoke tests                                                                           | - N/A                                                                   | - N/A                                                                                                                                                                                                                  | - N/A                                                                                                                                                                                               |
